
## 고정점 반복법 (Fixed Point Iteration)

함수 $f(x)$ 에 대해 $f(x)=x$ 를 만족하는 점 $x$ 를 $f$ 의 고정점 (fixed point) 라 한다. 고정점 자체가 중요한 경우도 많으며, 방정식의 해를 찾는것과 밀접하게 연관되어 있다. $g(x) = f(x)-x$ 라 놓으면 $f(x)$ 의 고정점을 찾는 것은 $g(x)$ 의 해를 찾는 문제와 같은 문제라는 것을 쉽게 이해 할 수 있을 것이다. 역으로, 함수 $g(x)=0$ 의 해를 찾는 문제는 $f(x) = g(x)  + x$ 의 고정점을 찾는 문제와 동일한 문제이다.

고정점 반복법이 가능한 이유는 아래의 고정점 정리 때문이다.

::: {#thm-fixed_point}
#### 고정점 정리

$f$ 가 $[a,\,b]$ 구간에서 연속이며 $f([a,\,b])\subset [a,\,b]$ 이면,

($1$) $f(x)=x$ 를 만족하는 고정점 $x$ 가 $[a,\,b]$ 구간에 존재한다.

($2$) 모든 $x,\,y \in [a,\,b]$ 에 대해 $|f(x)-f(y) |\le \lambda |x-y|$ 를 만족하는 $\lambda\in\mathbb{R}$ 이 존재하며,  $0<\lambda<1$ 이면, 고정점은 유일하다.

($3$) ($2$)의 조건을 만족시킬 때, 임의의 $x_1\in [a,\,b]$ 와 $x_{n+1}=f(x_n)$ 으로 정의되는 수열 $\langle x_n\rangle$ 은 수렴한다.

:::

::: {.proof}
($1$) $f(a)=a$ 이거나 $f(b)=b$ 이면 자명하므로 $f(a)\ne a,\, f(b) \ne b$ 인 경우만 생각한다. $g(x)=f(x)-x$ 라 하면 가정에 의해 $g(a)\ne 0,\, g(b) \ne 0$ 이다. 모든 $x\in [a,\,b]$ 에 대해 $a<f(x)<b$ 이므로 $g(a)=f(a)-a>0$ 이며 $g(b)=f(b)-b<0$ 이다. $g(x)$ 역시 $[a,\,b]$ 에서 연속이므로 중간값정리에 의해 $g(x)=0$ 인 $x\in(a,\,b)$ 가 존재해야 한다.  즉 $f(x)=x$ 를 만족하는 점 $x\in [a,\,b]$ 가 존재한다.

($2$) 고정점이 두개 이상 존재한다고 가정하고 두개의 임의의 고정점을 $p,\,q$ 라 하자. 그렇다면,
$$
|p-q | = |f(p)-f(q)| \le \lambda |p-q|< |p-q|
$$

이므로 모순이다. 따라서 고정점은 유일하다.

($3$) $p$ 를 유일한 고정점이라고 하자.

$$
|p-x_{n+1}| = |f(p) - f(x_n)| \le \lambda |p-x_n| \le \lambda^{n-1}|p-x_1|
$$

이므로 $\displaystyle \lim_{n \to \infty} x_n = p$ 이다. $\square$

:::

</br>

::: {#cor-for_fixex_point_theorem}

$[a,\,b]$ 구간에서 미분가능한 함수 $f(x)$ 가 $f([a,\,b])\subset [a,\,b]$ 이며, 어떤 양수 $0<\xi<1$ 에 대해 $x\in [a,\,b] \implies |f'(x)|<\xi$ 이면, $[a,\,b]$ 구간에서 유일한 고정점을 가진다.

:::


::: {.proof}
고정점 정리의 ($2$) 를 생각하자. $[a,\,b]$ 구간에서 $f$ 가 미분가능이므로 중간값 정리에 의해 $\dfrac{f(x)-f(y)}{x-y}=f'(\theta)$ 인 $\theta\in [a,\,b]$ 가 존재하며, $|f'(x)|<\xi<1$ 이므로
$$
|f(x)-f(y)|=|f'(\theta)||x-y|<\xi |x-y|
$$

이다. 따라서 $f(x)$ 는 $[a,\,b]$ 구간에서 유일한 고정점을 가진다. $\square$

:::

</br>

::: {#exm-fixed_point_1}

함수 $f(x) = x^2-2$ 를 생각하자. $f(0)=-2$ 이며 $f(2)=2$ 이므로 $[0,\,2]$ 구간에서 해가 반드시 존재한다. 


:::

::: {#exm-fixed_point_2}

이제 고정점 정리를 이용하여 $f(x)=x^3 − 2x^2 − 1 = 0$ 의 해를 $[1,\,3]$ 구간에서 구해보자. $g(x) = x-f(x)$ 로 놓으면, $g(1) = 3,\, g(3)=-5$ 이므로  고정점 정리의 가정 $g([a,\,b]) \subset [a,\,b]$ 에 위배된다.
$p$ 가 $f(x)$ 의 해이면 $p^3 = 2p^2+1$ 이므로 $p$ 는 $h(x) = (2x^2+1)^{1/3}$ 의 해이다. $h(1) \approx 1.442,\, h(3) \approx 2.668$ 이므로 $h(x)$ 는 고정점 정리의 제 1 조건을 만족한다. 또한

$$
h'(x) = \dfrac{4x}{3(2x^2+1)^{2/3}}
$$

이며, $x\in [1, 3]$ 이므로 $x>0$ 이다. 따라서 $[1,\,3]$ 구간에서,

$$
|h'(x) | = \dfrac{4|x|}{|3(2x^2+1)^{2/3}|} \le \dfrac{4|x|}{|3(2x^2+1)^{1/2}|} \le \dfrac{4|x|}{|3(2x^2)^{1/2}|}  < \dfrac{4}{3\sqrt{2}} <0.943< 1
$$

이므로 $h(x)$ 는 $[1,\,3]$ 구간에서 유일한 고정점을 가진다.

:::


```julia
function fixedpoint(f::Function, xi::T, xtol::T=1.0e-10, MaxIter::Int64 = 100_000)::T where T<:AbstractFloat
    Niter = 0
    for i in 1:MaxIter
        c = f(xi)
        if abs(c-xi) < xtol
            return c
        else
            xi = c
            Niter += 1
        end
    end
    error("최대 반복 횟수 $MaxIter 에 도달하였으나 답을 찾지 못함.")
end

h(x) = (2x^2+1)^(1/3)
fixedpoint(h, 2.0)
```

여기서 얻은 결과는 `2.2055694302615003` 이다.  


</br>
